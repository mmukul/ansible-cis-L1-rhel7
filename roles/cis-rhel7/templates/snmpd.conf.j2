# {{ ansible_managed }}

###############################################################################
#
# snmpd.conf:
#   An example configuration file for configuring the ucd-snmp snmpd agent.
#
###############################################################################

# First, map the community name "public" into a "security name"

#       sec.name  source          community

{% for item in cis_snmp_servers %}
com2sec notConfigUser {{ item.server }} {{ item.community }}
{% endfor %}

####
# Second, map the security name into a group name:

#       groupName      securityModel securityName
group   notConfigGroup v1           notConfigUser
group   notConfigGroup v2c           notConfigUser

####
# Third, create a view for us to let the group have rights to:

# Make at least  snmpwalk -v 1 localhost -c public system fast again.
#       name           incl/excl     subtree         mask(optional)
view    all           included   .1
view    systemview    included   .1.3.6.1.2.1.1
view    systemview    included   .1.3.6.1.2.1.25.1.1

####
# Finally, grant the group read-only access to the systemview view.

#       group          context sec.model sec.level prefix read   write  notif
access  notConfigGroup ""      any       noauth    exact  all none none

syslocation {{ cis_snmp_syslocation }}
syscontact  {{ cis_snmp_syscontact }}

dontLogTCPWrappersConnects yes

# Where to send traps
{% for item in cis_snmp_trapsink %}
trapsink {{ item.server }} {{ item.community }}
{% endfor %}
